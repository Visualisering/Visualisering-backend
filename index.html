<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>iViz-datasupplier</title>
</head>

<body>
    <h1>iViz-datasupplier</h1>
    <p>This is the backend-server for the opensource-project "Visualisering". Here you will find information about how to connect to the webhook to check out current data available</p>
    <h2>Connect client to websocket</h2>
    <p>Create your own connection to the websocket-server by connecting to: </p>
    <!--if working with your own app, please change address to websocket to the address of your running application-->
    <pre>ws://iviz-back.herokuapp.com/</pre>
    <p></p> Depending on framework and libraries used this can be done in different ways, but usually, you create a connection to the websocket-server by using: </p>
    <pre>
    <!--if working with your own app, please change address to websocket to the address of your running application-->
      let ws = new WebSocket("ws://iviz-back.herokuapp.com");
  </pre>
    <h2>Recieve data from websocket</h2> Once connected to the websocket-server, you can get hold of the data through sending the message:
    <pre>{"type":"WS_REQUEST_DATA"}</pre> to the server. This can be done by using:
    <pre>ws.send({"type":"WS_REQUEST_DATA"});</pre>to the server.

    <p> You can find more information about using websockets and writing client-side applications using websockets on MDN: <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API">Websockets on Mozilla Developer Network</a></p>

    <h2>Data currently available</h2>

    <p>Once asking for data, you will then get a response with the following content:</p>
    <ul>
        <li>"positions": Gives an array with objects containing latitude, longitude and a unix timestamp for commits made in the repos defined in the application, updated everyday at 22 CET.</li>
        <li>"commits": Gives an array with objects containing reponame, owner of repo, timestamp, message, committer, filename and code from the file(base64-encoded) for commits made in the repos defined in the application, updated everyday at 22 CET.</li>
        <li>"wh_commits: Same info as in "commits" but data is recieved through posts to /commit from github-webhooks defined in repos, data is recieved in real-time</li>
        <li>"wh_positions: Same info in "positions" but data is recieved through post to /commit from github-webhooks defined in repos, data is recieved in real-time</li>
    </ul>
    <p> Each time new data is available on the server, the websocket-server will push this to the clients connected. </p>

    <h2>Connect new webhook to websocket</h2>
    <p> Please note, if you want to use your own data, please fork this repo and deploy it at an own server. Then add the route http://yourownapp.org/commit to a webhook on the repo you want to listen to. The server handles push-events from the github-api.</p>
    <h2>Customize...</h2>
    <p>Please fork this repo and configure with your own repos and use your own webhooks! Read further on the repo-readme for instructions how to customize your application. Do you want to change something or add more functionality, please make a pullrequest!</p>
    <a href="https://github.com/Visualisering/Visualisering-backend.git">iViz repo!</a>
</body>

</html>